var sha256 = require('sha256');
var fs = require('fs');

var test = function() {
  var rolls = [
    {
      gameId:3123,
      roll: 1
    }, {
      gameId: 3127,
      roll: 14
    }, {
      gameId: 3133,
      roll: 3
    }, {
      gameId: 3131,
      roll: 1
    }, {
      gameId: 3132,
      roll: 14
    }
  ];
  var i = 105941965;
  while(true) {
    // console.clear();
    // console.log('checking...', i);
    if(check(i, rolls)) {
      fs.appendFileSync('result.txt', i + "\n");
      console.log("YAY!", i);
    }
    i++;
  }
}

var check = function(secret, rolls) {
  for(var i = 0; i < rolls.length; i++) {
    var sh = sha256(secret+"-"+rolls[i].gameId);
    var roll = sh.substr(0, 8);
    roll = parseInt(roll, 16);
    roll = Math.abs(roll) % 15;
    if(roll != rolls[i].roll)
      return false;
  }
  return true;
}

var secondTest = function() {
  // var entries = [142165 ,1309062 ,2066139 ,4937050 ,7908838 ,9212793 ,9483693 ,9712072 ,9837567 ,11289802 ,11448921 ,11654031 ,13320199 ,14824272 ,15014084 ,15609990 ,17890906 ,19937399 ,20363600 ,20763937 ,21443061 ,22521445 ,22743580 ,23675033 ,24315597 ,26608918 ,26742206 ,27342382 ,30183214 ,30480604 ,30830463 ,32090343 ,32913261 ,34282801 ,35212972 ,35369144 ,36465740 ,37461925 ,37472120 ,37692378];
  // var entries = [142165,1309062,2066139,4937050,7908838,9212793,9483693,9712072,9837567,11289802,11448921,11654031,13320199,14824272,15014084,15609990,17890906,19937399,20363600,20763937,21443061,22521445,22743580,23675033,24315597,26608918,26742206,27342382,30183214,30480604,30830463,32090343,32913261,34282801,35212972,35369144,36465740,37461925,37472120,37692378,40941985,40970540,42600121,45505428,48460355,49348524,50283705,50834786,50922417,51386018,51703809,52629669,53111751,53502332,53562177,54943386,56493559,56914668,56981522,59298750,60093474,60371313,61184207,61267487,62011747,63602609,67283091,67284667,68550186,68883443,69082041,69666529,70842343,70897703,71252459,71612518,73231250,73549158,73597923,74124804,74345319,74416237,75413085,75415507,76476645];
  var entries = [77697537,77765430,77972438,78929875,79385305,79559929,79849962,80403558,81776962,82454389,83014825,83070783,84091638,84252747,84914576,85013977,85344154,85408560,85998301,86759270,87069754,87829046,87885536,88078932,88441687,89113017,90004647,90950116,92216207,92236512,92581227,92835165,95905167,96275840,97339582,98012114,98355807,98837925,100144732,100650997,101493228,102617103,102732843,104525704,104785111,105941965];
  var rolls = [{
    gameId: 3165,
    roll: 13
  }, {
    gameId: 3175,
    roll: 6
  }];
  for(var i = 0; i < entries.length; i++) {
    if(check(entries[i], rolls)) {
      fs.appendFileSync('result_2.txt', entries[i] + "\n");
      console.log("YAY!!", entries[i]);
    }
  }
}

// test();
secondTest();

// var sh = sha256(hash+'-'+currentRollid);
// roll = sh.substr(0, 8);
// roll = parseInt(roll, 16);
// roll = math.abs(roll) % 15;




